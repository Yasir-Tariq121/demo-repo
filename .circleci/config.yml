version: 2.1
parameters:
  environment:
    type: string
    default: test-env # from circleci context
  stack:
    type: string
    default: test-stack
jobs:
  bar:
    machine:
      image: ubuntu-2004:202104-01
    steps:
      - checkout
      - run:
          name: test step
          command: |
            echo test step
      
workflows:
  build:
    jobs:
      - bar:
          pre-steps: # steps to run before steps defined in the job bar
            - run:
                command: echo "install custom dependency"
          post-steps: # steps to run after steps defined in the job bar
            - run:
                command: echo "upload artifact to s3"
# workflows: 
#   version: 2
#   run_cdk_dev:
#     jobs:
#       - Job1:
#           filters:
#             branches:
#               only: main
#           context: dev
#           post-step:
#             - run:
#                 command: echo "this is a post step"